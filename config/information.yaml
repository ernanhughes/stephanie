defaults:
  - _self_
  - db: postgres
  - bus: zmq
  - plan_monitor: disabled
  - logging: json_logger
  - services: all
  - scorer: all

  # Critic pipeline agents
  - agents/ingest
  - agents/section_research
  - agents/reasoned_encyclopedia
  - agents/fast_encyclopedia
  - agents/info_loader
  - agents/creative_association
  - agents/critic_loader
  - agents/critic_improver
  - agents/critic_evaluation


embeddings:
  backend: hnet


# ---------------------------------------------------------------------
# High-level goal conditioning: why we are running this pipeline
# ---------------------------------------------------------------------
goal:
  source: "driver"
  goal_type: "tactical"
  goal_category: "visual_graph_memory"

  # ✦ NEW: Cleaner narrative explaining why this pipeline exists ✦
  goal_text: >
    Evaluate and refine Stephanie’s internal critic by constructing a
    VisiCalc-based cohort analysis across chat turns, identifying stable
    high-signal behavioral features, training a compact critic model, and
    validating its predictive power via HRM/SICQL/EBT agreement. Produce a
    full lifecycle artifact set (raw → metrics → VPM → cohort summaries →
    critic model → improvement deltas) that together form a self-improving
    feedback loop.

  strategy:
    - "cohort_metric_analysis"        # VisiCalc → baseline → targeted
    - "critic_training"               # Train TinyCritic on extracted features
    - "model_evaluation"              # HRM + SICQL + EBT cross-checks
    - "visual_reasoning"              # VPM and color-normalized A/B frames
    - "feedback_integration"          # Update scorer configs & calibration

  expected_formats:
    - "visicalc_report_json"
    - "visicalc_feature_matrix"
    - "critic_dataset_csv"
    - "critic_model_joblib"
    - "critic_cross_validation_md"
    - "ab_vpm_filmstrip"
    - "model_quality_metrics_json"

  success_criteria:
    min_goal_alignment_improvement: 0.05
    min_signal_lift_p80: 0.05
    require_cross_model_agreement: true
    prefer_low_variance_visicalc_features: true

  scorer_signals:
    - "SICQL"
    - "EBT"
    - "HRM"

  calibration:
    color_scale: "global_full_pipeline"
    winsorize_pct: 1.0


paths:
  prompts: ${hydra:runtime.cwd}/prompts

report:
  generate_report: true
  path: ${hydra:runtime.cwd}/reports


# ---------------------------------------------------------------------
# Pipeline execution graph (linear, but goals-aware)
# ---------------------------------------------------------------------
pipeline:
  name: paper_to_blog
  tag: paper_to_blog
  description: >
    Will take a research paper as input and generate a blog post. 
    Converts it to a casebook and memcube during this process.

  stages:

    # ------------------------------ Yes Hey---------------------------------

    - name: info_loader
      description: >
        Load input documents from specified sources (e.g., local files,
        URLs, databases) into the system for processing.
      cls: stephanie.components.information.agents.knowledge.document_loader.DocumentLoaderAgent
      enabled: false
      iterations: 1

    - name: ingest
      description: >
        Pull raw signal data from Huggingface or other sources. This builds
        the foundational corpus of scorables used by VisiCalc.
      cls: stephanie.components.information.agents.ingest.InformationIngestAgent
      enabled: true
      iterations: 1

    - name: section_research
      description: >
        For each ingested document, build evidence bundles per section using
        embeddings + retrieval, and optionally generate improved section drafts.
      cls: stephanie.components.information.agents.section_research.SectionResearchAgent
      enabled: true
      iterations: 1

    - name: fast_encyclopedia
      description: >
        Quickly compile researched sections into a coherent blog post
        using a straightforward summarization approach.
      cls: stephanie.components.information.agents.paper_to_ideas_blog.PaperToIdeasAndBlogAgent
      enabled: true
      iterations: 1  well oh seems weird

    - name: reasoned_encyclopedia
      description: >
        Enhance researched sections by applying a reasoned memento process
        that iteratively refines content based on multi-dimensional evaluation.
      cls: stephanie.components.information.agents.reasoned_encyclopedia.ReasonedEncyclopediaAgent
      enabled: false
      iterations: 1

    - name: creative_association
      description: >
        Generate novel ideas and associations related to the content,
        enhancing creativity and depth in the final output.
      cls: stephanie.components.information.agents.association.CreativeAssociationAgent
      enabled: true
      iterations: 1

    - name: creative_association
      description: >
        Generate novel ideas and associations related to the content,
        enhancing creativity and depth in the final output.
      cls: stephanie.components.information.agents.association.CreativeAssociationAgent
      enabled: true
      iterations: 1