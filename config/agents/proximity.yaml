# configs/agents/proximity.yaml

proximity:
  name: proximity
  enabled: true
  source: database
  batch_size: 10

  similarity_threshold: 0.75  # Only show pairs with at least 75% similarity
  max_graft_candidates: 3   # Max number of pairs to suggest for grafting
  use_database_search: true # Whether to pull past hypotheses from DB
  top_k_database_matches: 10  # How many prior hypotheses to retrieve

  proximity_score_config: config/scoring/proximity.yaml

  save_context: false
  skip_if_completed: false

  # Required keys for the agent ot effectively process the context
  required_keys: ["goal", "hypotheses"]   # add nodes
  # Key that it will iterate over ot generate reflections
  input_key: "hypotheses"
  # Key that it store the results of those reflections
  output_key: "proximity"  # change

  metrics:
    # ðŸ”¹ Classical Text Similarity
    - name: cosine
      weight: 1.0    # Standard baseline for embeddings
    - name: jaccard
      weight: 0.6    # Token-level overlap; good for redundancy detection
    - name: tfidf
      weight: 0.8    # Keyword relevance; pairs well with embeddings

    # ðŸ”¹ Embedding Proximity (core of Stephanie)
    - name: avg_similarity
      weight: 1.2    # Strong signal: overall semantic closeness
    - name: max_similarity
      weight: 1.0    # Useful for near-duplicate spotting
    - name: min_similarity
      weight: 0.5    # Outlier detection
    - name: avg_topk_similarity
      weight: 1.1    # Captures clustering effect
    - name: similarity_variance
      weight: 0.7    # Spread of cluster tightness (uncertainty)
    - name: graft_pair_count
      weight: 0.9    # How many strong overlaps (â‰¥ threshold) exist

    # ðŸ”¹ Cluster / Diversity Measures
    - name: cluster_density
      weight: 1.0    # Ratio of high-similarity pairs / all pairs
    - name: redundancy_index
      weight: 0.8    # Inverse of diversity; penalizes too many duplicates
    - name: novelty_index
      weight: 0.9    # Encourages fresh hypotheses; high if min_similarity is low

    # ðŸ”¹ Knowledge Base Proximity
    - name: db_match_score
      weight: 1.0    # Similarity to top-k past hypotheses (retrieved from DB)
    - name: db_overlap_count
      weight: 0.7    # Count of past hypotheses above threshold
    - name: db_diversity
      weight: 0.6    # Ensures retrieved matches arenâ€™t just duplicates

    # ðŸ”¹ Advanced/Optional (can be enabled later)
    - name: hnet_alignment
      weight: 1.1    # Alignment between H-Net embeddings & raw embeddings
    - name: contrastive_rank
      weight: 0.9    # Contrastive score (reward separation of close/far items)
    - name: info_entropy
      weight: 0.8    # Entropy of similarity distribution (uncertainty)

